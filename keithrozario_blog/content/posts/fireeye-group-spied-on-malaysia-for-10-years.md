+++
title = "FireEye: Group spied on Malaysia for 10 years"
slug = "fireeye-group-spied-on-malaysia-for-10-years"
date = "2015-04-13T16:11:22"
draft = false
tags = ['Spyware']
categories = ['Malaysia', 'Security &amp; Privacy']
+++

<p style="text-align: justify;">

![Spying Program](/uploads/314989744_5b5a852b47_z.jpg "Courtesy of KIT:")

The team over at the <a title="FireEye Threat intelligence" href="https://www.fireeye.com/" target="_blank">FireEye threat intelligence</a> published a <a title="FireEye Special Report" href="https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf" target="_blank">special report(pdf)</a> detailing an long running (and still on-going) cyber-espionage operation that has targeted multiple entities in ASEAN countries, including Malaysia. The program was reported to be running for more than a decade, and the sustained period coupled with the list of targets the program had, led FireEye to believe it to be a state-sponsored activity, as no other other type of organization would be able to afford such a professionally run program, operated for such a long period of time with no discernible source of income.</p>
<p style="text-align: justify;">The group were nicknamed APT30, an abbreviation for Advanced Persistent Threat number 30 (I'm guessing the 30 part, because FireEye have other APTs on their github page). APT is a cyber-security term coined to identify an attacker that has both the capability and persistence to target specific entities up until they eventually break, and then continue to suck information from their victims for a significant amount of time. Basically there are script kiddies, hackers and then the 'Advanced Persistent Threats', APTs are a class above the rest.</p>
<p style="text-align: justify;"><em>APT30 </em>operated a suite of tools including back-doors, and command and control software that were given catchy names like Backspace, NetEagle, Flashflood and ShipShape. The tools demonstrated a fair amount of sophistication in the way the functioned, but what really impressed the FireEye team was the level of professionalism that the coders exhibited, the malware had a well defined version control system, automated tools to manage many of the operational task and even the functionality that allowed for the system to be operated 24/7 by a team working on shifts, with one window requesting the operator to enter their 'attendant code'. I wouldn't be surprised if the system even calculated yearly increments, and provided KPI reports in the background.<!--more--></p>


[caption id="attachment_4935" align="alignleft" width="300"]![affected countries Neteagle Backspace](/uploads/affected-countries-Neteagle-Backspace-300x170.png) List of affected countries prominently included Malaysia[/caption]
<p style="text-align: justify;">This isn't some rift-raft put together from <a title="Hacking ISIS" href="http://thehackernews.com/2015/04/hacking-wordpress-isis.html" target="_blank">wannabe ISIS hackers attacking already vulnerable websites</a>, this is a professionally run team, operating sophisticated malware, aimed at key diplomatic targets. The report claims that the developers of the code exhibited <em>"carefully managed versioning systems and a consistent method for checking version information, performing updates, and ensuring only a single copy of a given tool is running on a victim host at any time"</em>. I know of multi-million dollar software vendors that don't exhibit that level of control over their software versions.</p>
<p style="text-align: justify;">Fortunately, this well executed version control also allowed the team at FireEye to identify different versions of the software and the dates of their releases, then they tied those dates to various events in ASEAN, from 2011 ASEAN Summit in Jakarta, all the way to ASEAN-India Commemorative Summit in New Delhi a year later. These diplomatic events, which usually involve high level talks, correlate nicely to new releases of the malware that are too close to be coincidence. It would seem the APT30 group always shipped the latest and greatest versions just before the summits to ensure they siphoned off as much information as they could.</p>


[caption id="attachment_4936" align="aligncenter" width="689"]![key-dates](/uploads/key-dates-689x500.png) List of dates of new versions of the Malware, coinciding with events in ASEAN. Courtesy of FireEye.[/caption]
<p style="text-align: justify;">And if the list of targets, and the dates of new releases were not enough to convince you, the final 'nail in the coffin' was the way in which the infections took place. FireEye released a list of 'decoy documents', which were documents used in phishing e-mails to infect users, once the users opened the decoys, the malware would deploy and the machined would be owned. Decoy documents are usually a great way to determine the target group of an attack, malware targeting football players are going to have different decoy than if it were targeting banking officials, decoy documents for French speaking victims should be written in French, and so on.</p>
<p style="text-align: justify;">In the case of APT30, 4 decoy documents were published in the report, but the one that caught my attention was titled <em>"Report on China's border security situation"</em> that focused on territorial disputes between China and some of its neighbouring countries, and how that affected the security situation in the region.</p>
<p style="text-align: justify;">Gee...I wonder who has a <a title="Wikipedia Spratly Islands Dispute" href="https://en.wikipedia.org/wiki/Spratly_Islands_dispute" target="_blank">territorial dispute with China</a>? <em>(hint: it begins with 'M' and ends with 'alaysia')</em></p>
<p style="text-align: justify;">Put that together with the fact, that the software has Mandarin all over it seems to lead to only one conclusion:</p>

<blockquote>This was a sophisticated decade old Chinese state-sponsored operation that targeted officials in ASEAN and East Asian countries and was used to gather information from people close to issues such as Territorial disputers, boundary talks and Indian defense purchases.</blockquote>
<h2 style="text-align: justify;"></h2>
<h2 style="text-align: justify;">Is this 'shocking'?</h2>
<p style="text-align: justify;">No.</p>
<p style="text-align: justify;">If you think that this sort of espionage is new, or that this represents a higher level of spying, you need to think again.</p>
<p style="text-align: justify;">Think about the fastest plane mankind has ever built, the Sr-71 blackbird, built by the CIA to spy on the Soviet Union and its satellite states. The desire to spy on Soviet missile installations was so great that the CIA built a plane capable of flying 3.3 times the speed of sound, at an altitude 3 times higher than the peak of Mt. Everest---all in the good ol' days of 1966!! You read that right, the fastest plane ever built came into production when England last won the world cup, that's REALLLY long ago.</p>
<p style="text-align: justify;">If you think this new piece of malware from China is 'sophisticated spying', what the hell do you call the Blackbird?</p>


[caption id="attachment_4938" align="alignright" width="300"]![Regin-graph-two](/uploads/Regin-graph-two-300x188.png) List of countries affect by Regin from Kaspersky, see anyone familiar?[/caption]
<p style="text-align: justify;">And even if we confine ourselves to digital spyware, APT30 still isn't the most sophisticated attacker we've seen. Last year <a title="Kaspersky Regin report" href="https://securelist.com/blog/research/67741/regin-nation-state-ownage-of-gsm-networks/" target="_blank">Kaspersky</a> and Symantec independently discovered Regin, another state-sponsored piece of malware that exhibited such a high degree of sophistication, <a title="Symantec Regin" href="https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf" target="_blank">Symantec called it 'groundbreaking' and 'peerless'</a>. And unlike APT30, Regin has been <a title="Attributed to the NSA and GCHQ" href="https://firstlook.org/theintercept/2014/11/24/secret-regin-malware-belgacom-nsa-gchq/" target="_blank">attributed to the NSA and the GCHQ</a>, agencies of Western countries that are certainly not aligned to China. Even then , Malaysia was one of the countries targeted by this peerless malware. I really wonder what kind of secrets we have that both the Chinese AND the Americans would spy on us.</p>

<blockquote>“In the world of malware threats, only a few rare examples can truly be considered groundbreaking and almost peerless,What we have seen in Regin is just such a class of malware.”
<p style="text-align: right;">-Symantec</p>
</blockquote>
<p style="text-align: justify;">The surprising thing about the APT30 revelations though is their targets, FireEye rightly claim that organization in Asia feel they won't be targeted by such advanced threats, but as this report clearly demonstrates groups like APT30 are successfully exploiting that complacency.</p>
<p style="text-align: justify;">FireEye go on to claim that 37% of their customers in Asia Pacific have detected advanced cyber attacks like those carried out by APT 30, which was above the global average of 27%. I'm actually quite shocked that the global average represents a quarter of their customers, while more than a third of their customers in APAC were attacked, that's pretty good odds that government linked companies may have been attacked already.</p>
<p style="text-align: justify;">I've been following cyber security news for some time now, but this piece really hits home because Malaysia was featured prominently as a targeted country (more prominently that the side note we got for Regin), and the level of sophistication and dedication the APT30 team demonstrated.</p>

<h2 style="text-align: justify;">Conclusion</h2>
<p style="text-align: justify;">The one thing I must commend FireEye on is their use of the correct term Cyber-Espionage, instead of the more maligned term Cyber-attack. This isn't an attack, this is good ol' fashion spying, and it's been around for ages, just that now we have the ability to attack from a distance, replacing spies like James Bond to anonymous geeks that sit behind computer screens and punch in attendant codes for their shifts.</p>
<p style="text-align: justify;">No one starts a war because they found a spy. The Soviets knew about the Blackbird and the U2, they could even spot the planes on radar, and the Libyans once tried to shoot it down. These were mortal enemies locked in cold-war conflict, and everybody knew the other was spying just as much as them.</p>
<p style="text-align: justify;">So no one is going to start a war just because we discovered things like APT30, or Regin, some might be angry or surprised, but this is just a digital version of something that's been around for centuries.</p>
<p style="text-align: justify;">To think, that a country like China with so much a stake in the South China Sea, and its enormous technical capability would sit back and not spy on Malaysia is preposterous, and doesn't fit into any model of super-power the world has historically seen. There hasn't been a single super-power nation state that didn't have an intelligence agency that was interested in the dealings of its neighbours and allies, and what exactly do you think these intelligence agencies do other than spying?</p>
<p style="text-align: justify;">We have to assume that we've already been infiltrated, the question is what do they know and how much do we tell them?</p>
<p style="text-align: justify;">The Geek in me though, just loves reading how sophisticated these attacks have become, and believe me folks, I have a feeling we ain't seen nothing yet.</p>